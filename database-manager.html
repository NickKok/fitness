<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fitness Workout Manager</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            color: #333;
        }
        h1 {
            color: #2c3e50;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
        }
        .workout {
            background-color: #f9f9f9;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 30px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .workout h2 {
            color: #2980b9;
            margin-top: 0;
        }
        .workout-meta {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-bottom: 15px;
        }
        .meta-box {
            background-color: #e8f4fc;
            padding: 8px 12px;
            border-radius: 5px;
            font-size: 0.9em;
        }
        .section {
            margin-bottom: 20px;
        }
        .section h3 {
            color: #16a085;
            margin-bottom: 10px;
        }
        .exercise {
            background-color: white;
            padding: 12px;
            margin-bottom: 8px;
            border-radius: 5px;
            border-left: 4px solid #3498db;
        }
        .exercise-name {
            font-weight: bold;
            color: #2c3e50;
        }
        .exercise-detail {
            margin-left: 10px;
            color: #7f8c8d;
        }
        .exercise-notes {
            font-style: italic;
            color: #7f8c8d;
            margin-top: 5px;
        }
        .tag {
            display: inline-block;
            background-color: #e0f7fa;
            color: #00838f;
            padding: 3px 8px;
            border-radius: 15px;
            font-size: 0.8em;
            margin-right: 5px;
            margin-top: 5px;
        }
        #workout-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 20px;
        }
        .controls {
            margin-bottom: 20px;
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        button, select {
            padding: 8px 12px;
            border-radius: 5px;
            border: 1px solid #bdc3c7;
            background-color: #ecf0f1;
            cursor: pointer;
        }
        button:hover {
            background-color: #d5dbdb;
        }
    </style>
</head>
<body>
    <h1>Fitness Workout Manager</h1>
    
    <div class="controls">
        <select id="workout-select">
            <option value="">Select a workout...</option>
        </select>
        <button id="load-btn">Load Workout</button>
        <select id="filter-focus">
            <option value="">Filter by focus area...</option>
            <option value="core">Core</option>
            <option value="legs">Legs</option>
            <option value="upper">Upper Body</option>
            <option value="cardio">Cardio</option>
        </select>
    </div>
    
    <div id="workout-list"></div>

    <script>
        // Global variable to store workout data
        let allWorkouts = [];
        
        // DOM elements
        const workoutSelect = document.getElementById('workout-select');
        const loadBtn = document.getElementById('load-btn');
        const filterFocus = document.getElementById('filter-focus');
        const workoutList = document.getElementById('workout-list');
        
        // Initialize the app
        async function init() {
            await loadWorkouts();
            populateWorkoutSelect();
            
            // Event listeners
            loadBtn.addEventListener('click', displaySelectedWorkout);
            filterFocus.addEventListener('change', filterWorkouts);
        }
        
        // Load workout data from JSON
        async function loadWorkouts() {
            try {
                const response = await fetch('https://gist.githubusercontent.com/NickKok/4fe0f3f65c05e3c00e1621c8381dcae6/raw/workout-routines.json');
                const data = await response.json();
                allWorkouts = data.workouts;
                console.log('Workouts loaded successfully:', allWorkouts);
            } catch (error) {
                console.error('Error loading workouts:', error);
                workoutList.innerHTML = '<div class="error">Failed to load workout data. Please try again later.</div>';
            }
        }
        
        // Populate the workout dropdown
        function populateWorkoutSelect() {
            workoutSelect.innerHTML = '<option value="">Select a workout...</option>';
            
            allWorkouts.forEach(workout => {
                const option = document.createElement('option');
                option.value = workout.id;
                option.textContent = workout.name;
                workoutSelect.appendChild(option);
            });
        }
        
        // Display the selected workout
        function displaySelectedWorkout() {
            const workoutId = workoutSelect.value;
            if (!workoutId) return;
            
            const workout = allWorkouts.find(w => w.id === workoutId);
            if (workout) {
                workoutList.innerHTML = renderWorkout(workout);
            }
        }
        
        // Filter workouts by focus area
        function filterWorkouts() {
            const focus = filterFocus.value;
            if (!focus) {
                workoutList.innerHTML = '';
                return;
            }
            
            const filtered = allWorkouts.filter(workout => {
                // Check circuit exercises
                if (workout.structure.circuit) {
                    return workout.structure.circuit.exercises.some(ex => 
                        ex.focus && ex.focus.includes(focus)
                    );
                }
                return false;
            });
            
            workoutList.innerHTML = filtered.map(workout => 
                renderWorkout(workout)
            ).join('');
        }
        
        // Render a workout to HTML
        function renderWorkout(workout) {
            return `
                <div class="workout" data-id="${workout.id}">
                    <h2>${workout.name}</h2>
                    <p>${workout.description}</p>
                    
                    <div class="workout-meta">
                        <div class="meta-box">Client: ${workout.client.name}</div>
                        ${workout.duration_minutes ? `<div class="meta-box">Duration: ${workout.duration_minutes} min</div>` : ''}
                        ${workout.client.focus_areas ? `<div class="meta-box">Focus: ${workout.client.focus_areas.join(', ')}</div>` : ''}
                    </div>
                    
                    ${renderWorkoutStructure(workout.structure)}
                    
                    ${workout.notes ? `<p class="notes"><strong>Notes:</strong> ${workout.notes}</p>` : ''}
                </div>
            `;
        }
        
        // Render workout structure sections
        function renderWorkoutStructure(structure) {
            let html = '';
            
            if (structure.warmup) {
                html += `
                    <div class="section">
                        <h3>Warmup</h3>
                        ${renderExercises(structure.warmup.exercises)}
                    </div>
                `;
            }
            
            if (structure.circuit) {
                html += `
                    <div class="section">
                        <h3>Circuit: ${structure.circuit.rounds} rounds</h3>
                        ${structure.circuit.pattern ? `<p>Pattern: ${structure.circuit.pattern}</p>` : ''}
                        ${renderExercises(structure.circuit.exercises)}
                        
                        ${structure.circuit.intervals ? `
                            <div class="interval">
                                <h4>Intervals</h4>
                                ${renderExercise(structure.circuit.intervals.burpees)}
                            </div>
                        ` : ''}
                    </div>
                `;
            }
            
            if (structure.cooldown) {
                html += `
                    <div class="section">
                        <h3>Cooldown</h3>
                        ${renderExercises(structure.cooldown.exercises)}
                    </div>
                `;
            }
            
            return html;
        }
        
        // Render a list of exercises
        function renderExercises(exercises) {
            return exercises.map(ex => renderExercise(ex)).join('');
        }
        
        // Render a single exercise
        function renderExercise(exercise) {
            let details = '';
            
            if (exercise.reps) {
                details = `${exercise.reps} reps`;
            } else if (exercise.duration_sec) {
                details = `${exercise.duration_sec} sec`;
            }
            
            if (exercise.tempo) {
                details += ` (Tempo: ${exercise.tempo})`;
            }
            
            if (exercise.hold_sec) {
                details += ` (Hold: ${exercise.hold_sec} sec)`;
            }
            
            return `
                <div class="exercise">
                    <div class="exercise-name">${exercise.name}</div>
                    <div class="exercise-detail">${details}</div>
                    ${exercise.notes ? `<div class="exercise-notes">${exercise.notes}</div>` : ''}
                    ${exercise.focus ? `
                        <div class="exercise-tags">
                            ${exercise.focus.map(f => `<span class="tag">${f}</span>`).join('')}
                        </div>
                    ` : ''}
                    ${exercise.attributes ? `
                        <div class="exercise-tags">
                            ${exercise.attributes.map(a => `<span class="tag">${a}</span>`).join('')}
                        </div>
                    ` : ''}
                </div>
            `;
        }
        
        // Initialize the application
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>